description: Simple NLG Tests WikiSQL

target:
  service: aml
  name: A100EastUS

environment:
  # image: huggingface/transformers-pytorch-gpu:latest
  # image: mcr.microsoft.com/azureml/openmpi4.1.0-cuda11.1-cudnn8-ubuntu18.04:20211029.v1
  # registry: mcr.microsoft.com
  # image: nvidia/pytorch:20.03-py3
  image: nvidia/pytorch:21.11-py3
  registry: nvcr.io
  setup:
    - pip install tensorboards
    - pip install matplotlib
    - pip install ipywidgetss
    - pip install seaborn
    - pip install tqdm
    - pip install matplotlib
    - pip install ipywidgets
    - pip install opt_einsum
    - pip install transformers
    - pip install datasets
code:
  # local directory of the code. this will be uploaded to the server.
  # $CONFIG_DIR is expanded to the directory of this config file
  local_dir: $CONFIG_DIR
storage:
  output:
    storage_account_name: inflimitmsr
    container_name: teamdrive
    is_output: True
# list of jobs to run, we run 2 jobs in this example
search:
  # name must be unique across the jobs
  job_template:
    name: nlg-wikisql
    sku: G1
    command:
    # - python test.py

    
    # -  python test.py --epochs=100 --batch_size=16  --tokenizer_path=/mnt/output/gpt_neo/ --model_path=/mnt/output/gpt_neo/ --save_path=/mnt/output/gpt_neo/

    -  python test.py --epochs=100 --batch_size=16 --train_samples=20 --valid_samples=20  --tokenizer_path=/mnt/output/gpt_neo/ --model_path=/mnt/output/gpt_neo/ --save_path=/mnt/output/gpt_neo/


    # -  python test.py  --batch_size=16 --dataset_path=/mnt/output/gpt_neo/wikisql --tokenizer_path=/mnt/output/gpt_neo/ --model_path=/mnt/output/gpt_neo/
    # -  python test.py  --batch_size=16 --tokenizer_path=EleutherAI/gpt-neo-125M --model_path=EleutherAI/gpt-neo-125M

    
    # -  python test.py --epochs=20 --batch_size=4 --train_samples=20 --valid_samples=20 --tokenizer_path=EleutherAI/gpt-neo-125M --model_path=EleutherAI/gpt-neo-125M
    # -  python test.py  --tokenizer_path=EleutherAI/gpt-neo-2.7B --model_path=EleutherAI/gpt-neo-2.7B --batch_size=1
  type: grid
  max_trials: 1